[gd_scene load_steps=28 format=3 uid="uid://3txoxcmhlqf4"]

[ext_resource type="Script" uid="uid://ds8mpidl03flq" path="res://scripts/managers/game_manager.gd" id="1_4w45t"]
[ext_resource type="Script" uid="uid://cj36cjoo4751e" path="res://scripts/managers/api_manager.gd" id="1_58gk3"]
[ext_resource type="Script" uid="uid://dfyjdsog1fy7v" path="res://scripts/ui/ui_item_manager.gd" id="1_pu3yx"]
[ext_resource type="PackedScene" uid="uid://hhwydbml1pxj" path="res://scenes/templates/item_template.tscn" id="1_si52b"]
[ext_resource type="Texture2D" uid="uid://4121s6jxng6r" path="res://assets/textures/ui/inventory/inventory_grid.png" id="1_w2twt"]
[ext_resource type="Script" uid="uid://c1wrfovotnets" path="res://scripts/ui/ui_manager.gd" id="2_e1cbu"]
[ext_resource type="Script" uid="uid://d0q6asix6qkpp" path="res://scripts/ui/ui_inventory.gd" id="2_gubc5"]
[ext_resource type="Material" uid="uid://fs2qwxy2iiwe" path="res://assets/materials/outline/outline_shader_material.tres" id="2_rt2n2"]
[ext_resource type="Script" uid="uid://1wnn8i14qql1" path="res://scripts/ui/ui_level_display.gd" id="7_c16ls"]
[ext_resource type="Script" uid="uid://4v4lxtijmd7q" path="res://scripts/managers/event_manager.gd" id="7_k6f3i"]
[ext_resource type="Texture2D" uid="uid://cyhrrm78wnk3i" path="res://assets/textures/ui/icons/unknown_event.png" id="8_6wevv"]
[ext_resource type="Script" uid="uid://bymfoc07b35y1" path="res://scripts/managers/fight_manager.gd" id="8_k6f3i"]
[ext_resource type="Texture2D" uid="uid://cxr3y6hsmbuka" path="res://assets/textures/ui/icons/connection.png" id="9_e1cbu"]
[ext_resource type="Texture2D" uid="uid://djyggohcy4eh0" path="res://assets/textures/ui/icons/linear_connection.png" id="10_4w45t"]
[ext_resource type="Texture2D" uid="uid://ctm71hnsrhqk5" path="res://assets/textures/ui/icons/pvp_fight.png" id="10_mngbo"]
[ext_resource type="Material" uid="uid://dcofqc06xashp" path="res://assets/materials/stylized_text/stylized_text_material.tres" id="11_adb74"]
[ext_resource type="Texture2D" uid="uid://cyx3o12vj6th" path="res://assets/textures/ui/inventory/storage_grid.png" id="12_mngbo"]
[ext_resource type="Script" uid="uid://sgws6qjtv6mk" path="res://scripts/managers/game_file_verifier.gd" id="13_4w45t"]
[ext_resource type="Texture2D" uid="uid://dtxk2qqwssgoa" path="res://assets/textures/ui/inventory/trash.png" id="14_r6p65"]
[ext_resource type="Script" uid="uid://dw2qkl00ectck" path="res://scripts/ui/ui_health_display.gd" id="21_adb74"]
[ext_resource type="Texture2D" uid="uid://cjoeqqi3l8tn6" path="res://assets/textures/ui/panels/reward.png" id="21_xdqt8"]

[sub_resource type="Gradient" id="Gradient_xdqt8"]
offsets = PackedFloat32Array(0.9970238)
colors = PackedColorArray(0.24705882, 0, 0, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_adb74"]
gradient = SubResource("Gradient_xdqt8")
width = 16

[sub_resource type="Gradient" id="Gradient_k6f3i"]
offsets = PackedFloat32Array(1)
colors = PackedColorArray(1.353256, 0, 0, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_xdqt8"]
gradient = SubResource("Gradient_k6f3i")
width = 16

[sub_resource type="Gradient" id="Gradient_adb74"]
offsets = PackedFloat32Array(1)
colors = PackedColorArray(0.49747366, 0.49747366, 0.49747366, 1)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_58gk3"]
gradient = SubResource("Gradient_adb74")
width = 16

[node name="main_scene" type="Node2D"]
position = Vector2(-224, -128)

[node name="APIManager" type="Node" parent="." node_paths=PackedStringArray("game_manager", "player_inventory")]
script = ExtResource("1_58gk3")
game_manager = NodePath("../GameManager")
player_inventory = NodePath("../PanelContainer Player Inventory")
metadata/_custom_type_script = "uid://cj36cjoo4751e"

[node name="GameFileVerifier" type="Node" parent="."]
script = ExtResource("13_4w45t")
metadata/_custom_type_script = "uid://sgws6qjtv6mk"

[node name="GameManager" type="Node" parent="." node_paths=PackedStringArray("game_file_verifier")]
script = ExtResource("1_4w45t")
game_file_verifier = NodePath("../GameFileVerifier")
metadata/_custom_type_script = "uid://ds8mpidl03flq"

[node name="UIManager" type="Node" parent="." node_paths=PackedStringArray("player_label", "event_container", "event_connection_1", "event_icon_1", "event_connection_2", "event_icon_2", "event_connection_3", "event_icon_3")]
script = ExtResource("2_e1cbu")
player_label = NodePath("../PanelContainer Player Inventory/Label Player name")
event_container = NodePath("../Control Proceed/HBoxContainer")
event_connection_1 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event connection 1")
event_icon_1 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event Icon 1")
event_connection_2 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event connection 2")
event_icon_2 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event Icon 2")
event_connection_3 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event connection 3")
event_icon_3 = NodePath("../Control Proceed/HBoxContainer/TextureRect Event Icon 3")
metadata/_custom_type_script = "uid://c1wrfovotnets"

[node name="UIItemManager" type="Node2D" parent="." node_paths=PackedStringArray("trash_inventory")]
script = ExtResource("1_pu3yx")
outline_material = ExtResource("2_rt2n2")
item_template = ExtResource("1_si52b")
trash_inventory = NodePath("../TextureButton Trash")

[node name="EventManager" type="Node2D" parent="." node_paths=PackedStringArray("camera", "api_manager", "game_manager", "fight_manager", "event_choice_container", "event_reward_container", "event_reward_center", "event_reward_roll_parent", "event_reward_take_button", "event_reward_gamble_button", "event_button_1", "event_button_2", "event_button_3", "proceed_button", "trash_inventory", "enemy_inventory", "enemy_label", "default_camera_position", "fight_camera_position", "fight_label")]
script = ExtResource("7_k6f3i")
camera = NodePath("../Camera2D")
api_manager = NodePath("../APIManager")
game_manager = NodePath("../GameManager")
fight_manager = NodePath("../FightManager")
event_choice_container = NodePath("../VBoxContainer Event selection")
event_reward_container = NodePath("../TextureRect Reward")
event_reward_center = NodePath("../TextureRect Reward/Control Center")
event_reward_roll_parent = NodePath("../TextureRect Reward/Control Center/Control Roll parent")
event_reward_take_button = NodePath("../TextureRect Reward/Button Take")
event_reward_gamble_button = NodePath("../TextureRect Reward/Button Gamble")
event_button_1 = NodePath("../VBoxContainer Event selection/Button Event 1")
event_button_2 = NodePath("../VBoxContainer Event selection/Button Event 2")
event_button_3 = NodePath("../VBoxContainer Event selection/Button Event 3")
proceed_button = NodePath("../Control Proceed/Button Proceed")
trash_inventory = NodePath("../TextureButton Trash")
enemy_inventory = NodePath("../PanelContainer Enemy Inventory")
enemy_label = NodePath("../PanelContainer Enemy Inventory/Label Enemy name")
default_camera_position = NodePath("../Control Default camera position")
fight_camera_position = NodePath("../Control Fight camera position")
fight_label = NodePath("../Label Fight label")
metadata/_custom_type_script = "uid://4v4lxtijmd7q"

[node name="FightManager" type="Node" parent="." node_paths=PackedStringArray("player_inventory", "enemy_inventory", "player_health_display", "enemy_health_display")]
script = ExtResource("8_k6f3i")
player_inventory = NodePath("../PanelContainer Player Inventory")
enemy_inventory = NodePath("../PanelContainer Enemy Inventory")
player_health_display = NodePath("../Control Player health origin")
enemy_health_display = NodePath("../Control Enemy health origin")
metadata/_custom_type_script = "uid://bymfoc07b35y1"

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(224, 128)
zoom = Vector2(2.571, 2.571)

[node name="PanelContainer Player Inventory" type="Control" parent="."]
z_as_relative = false
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 16.0
offset_top = 16.0
offset_right = 208.0
offset_bottom = 96.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 0
size_flags_vertical = 0
script = ExtResource("2_gubc5")
metadata/_edit_use_anchors_ = true

[node name="TextureRect GridTexture" type="TextureRect" parent="PanelContainer Player Inventory"]
z_index = 2
z_as_relative = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
texture = ExtResource("1_w2twt")
stretch_mode = 1
metadata/_edit_use_anchors_ = true

[node name="Label Player name" type="Label" parent="PanelContainer Player Inventory"]
material = ExtResource("11_adb74")
layout_mode = 0
offset_top = -14.0
offset_right = 192.0

[node name="PanelContainer Enemy Inventory" type="Control" parent="."]
z_as_relative = false
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 240.0
offset_top = 16.0
offset_right = 432.0
offset_bottom = 96.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 0
size_flags_vertical = 0
script = ExtResource("2_gubc5")
metadata/_edit_use_anchors_ = true

[node name="TextureRect GridTexture" type="TextureRect" parent="PanelContainer Enemy Inventory"]
z_index = 2
z_as_relative = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
texture = ExtResource("1_w2twt")
stretch_mode = 1
metadata/_edit_use_anchors_ = true

[node name="Label Enemy name" type="Label" parent="PanelContainer Enemy Inventory"]
modulate = Color(1, 0, 0, 1)
material = ExtResource("11_adb74")
layout_mode = 0
offset_top = -14.0
offset_right = 192.0
horizontal_alignment = 2

[node name="PanelContainer Storage" type="Control" parent="."]
z_as_relative = false
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 16.0
offset_top = 128.0
offset_right = 208.0
offset_bottom = 208.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 0
size_flags_vertical = 0
script = ExtResource("2_gubc5")
metadata/_edit_use_anchors_ = true

[node name="TextureRect GridTexture" type="TextureRect" parent="PanelContainer Storage"]
z_index = 2
z_as_relative = false
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
texture = ExtResource("12_mngbo")
stretch_mode = 1
metadata/_edit_use_anchors_ = true

[node name="VBoxContainer Event selection" type="VBoxContainer" parent="."]
offset_left = 288.0
offset_top = 34.0
offset_right = 432.0
offset_bottom = 130.0
alignment = 1

[node name="Label" type="Label" parent="VBoxContainer Event selection"]
material = ExtResource("11_adb74")
layout_mode = 2
text = "Choose event"
horizontal_alignment = 1

[node name="Button Event 1" type="Button" parent="VBoxContainer Event selection"]
material = ExtResource("11_adb74")
layout_mode = 2
toggle_mode = true
text = "Event 1"

[node name="Button Event 2" type="Button" parent="VBoxContainer Event selection"]
material = ExtResource("11_adb74")
layout_mode = 2
toggle_mode = true
text = "Event 2"

[node name="Button Event 3" type="Button" parent="VBoxContainer Event selection"]
material = ExtResource("11_adb74")
layout_mode = 2
focus_neighbor_bottom = NodePath("../../Control Proceed/Button Proceed")
toggle_mode = true
text = "Event 3"

[node name="Control Proceed" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_left = 288.0
offset_top = 142.0
offset_right = 432.0
offset_bottom = 222.0
mouse_filter = 2

[node name="Button Proceed" type="Button" parent="Control Proceed"]
material = ExtResource("11_adb74")
layout_mode = 0
offset_left = 16.0
offset_top = 50.0
offset_right = 128.0
offset_bottom = 66.0
focus_neighbor_top = NodePath("../../VBoxContainer Event selection/Button Event 3")
text = "Proceed"

[node name="HBoxContainer" type="HBoxContainer" parent="Control Proceed"]
layout_mode = 0
offset_left = 8.0
offset_top = 80.0
offset_right = 124.0
offset_bottom = 96.0

[node name="TextureRect Event connection 1" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("9_e1cbu")

[node name="TextureRect Event Icon 1" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("8_6wevv")

[node name="TextureRect Event connection 2" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("9_e1cbu")

[node name="TextureRect Event Icon 2" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("8_6wevv")

[node name="TextureRect Event connection 3" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("10_4w45t")

[node name="TextureRect Event Icon 3" type="TextureRect" parent="Control Proceed/HBoxContainer"]
layout_mode = 2
texture = ExtResource("10_mngbo")

[node name="Label Level" type="Label" parent="Control Proceed/HBoxContainer/TextureRect Event Icon 3"]
layout_mode = 0
offset_left = 20.0
offset_right = 26.0
offset_bottom = 14.0
text = "0"
horizontal_alignment = 1
script = ExtResource("7_c16ls")

[node name="TextureButton Trash" type="TextureRect" parent="."]
offset_left = 224.0
offset_top = 128.0
offset_right = 272.0
offset_bottom = 176.0
texture = ExtResource("14_r6p65")
script = ExtResource("2_gubc5")
container_size = Vector2i(3, 3)

[node name="TextureRect Reward" type="TextureRect" parent="."]
offset_left = 288.0
offset_top = 14.0
offset_right = 434.0
offset_bottom = 96.0
texture = ExtResource("21_xdqt8")

[node name="Control Center" type="Control" parent="TextureRect Reward"]
z_index = 4
clip_contents = true
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -73.0
offset_top = -40.0
offset_right = 73.0
offset_bottom = 40.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(73, 40)

[node name="Control Roll parent" type="Control" parent="TextureRect Reward/Control Center"]
anchors_preset = 0
offset_left = 73.0
offset_top = 40.0
offset_right = 74.0
offset_bottom = 40.0

[node name="Button Take" type="Button" parent="TextureRect Reward"]
material = ExtResource("11_adb74")
layout_mode = 0
offset_left = 1.0
offset_top = 97.0
offset_right = 65.0
offset_bottom = 113.0
text = "Take"

[node name="Button Gamble" type="Button" parent="TextureRect Reward"]
material = ExtResource("11_adb74")
layout_mode = 0
offset_left = 81.0
offset_top = 97.0
offset_right = 145.0
offset_bottom = 113.0
text = "Reroll"

[node name="Control Default camera position" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_left = 224.0
offset_top = 128.0
offset_right = 224.0
offset_bottom = 128.0

[node name="Control Fight camera position" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_left = 224.0
offset_top = -18.0
offset_right = 224.0
offset_bottom = -18.0

[node name="Marker2D Fight camera top edge" type="Marker2D" parent="."]
position = Vector2(224, -146)

[node name="Control Player health origin" type="Control" parent="." node_paths=PackedStringArray("current_health_bar", "health_bar", "block_bar")]
layout_mode = 3
anchors_preset = 0
offset_left = 16.0
offset_top = -2.0
offset_right = 16.0
offset_bottom = 2.0
script = ExtResource("21_adb74")
current_health_bar = NodePath("TextureRect Player current health")
health_bar = NodePath("TextureRect Player health")
block_bar = NodePath("TextureRect Player block")
metadata/_edit_use_anchors_ = true

[node name="TextureRect Player health" type="TextureRect" parent="Control Player health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_adb74")
expand_mode = 1
metadata/_edit_use_anchors_ = true

[node name="TextureRect Player current health" type="TextureRect" parent="Control Player health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_xdqt8")
expand_mode = 1
metadata/_edit_use_anchors_ = true

[node name="TextureRect Player block" type="TextureRect" parent="Control Player health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_58gk3")
expand_mode = 1
metadata/_edit_use_anchors_ = true

[node name="Control Enemy health origin" type="Control" parent="." node_paths=PackedStringArray("current_health_bar", "health_bar", "block_bar")]
layout_mode = 3
anchors_preset = 0
offset_left = 240.0
offset_top = -2.0
offset_right = 240.0
offset_bottom = 2.0
script = ExtResource("21_adb74")
current_health_bar = NodePath("TextureRect Enemy current health")
health_bar = NodePath("TextureRect Enemy health")
block_bar = NodePath("TextureRect Enemy block")

[node name="TextureRect Enemy health" type="TextureRect" parent="Control Enemy health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_adb74")
expand_mode = 1

[node name="TextureRect Enemy current health" type="TextureRect" parent="Control Enemy health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_xdqt8")
expand_mode = 1

[node name="TextureRect Enemy block" type="TextureRect" parent="Control Enemy health origin"]
layout_mode = 0
offset_top = -2.0
offset_bottom = 2.0
texture = SubResource("GradientTexture1D_58gk3")
expand_mode = 1

[node name="Label Fight label" type="RichTextLabel" parent="."]
material = ExtResource("11_adb74")
offset_left = 288.0
offset_top = 66.0
offset_right = 432.0
offset_bottom = 146.0
text = "Your opponent is:
shatahst
htsa"
horizontal_alignment = 1

[connection signal="event_changed_singal" from="GameManager" to="UIManager" method="_event_changed_callback"]
[connection signal="event_changed_singal" from="GameManager" to="EventManager" method="_event_changed_callback"]
[connection signal="level_increased_signal" from="GameManager" to="PanelContainer Player Inventory" method="_on_game_manager_level_increased_signal"]
[connection signal="level_increased_signal" from="GameManager" to="PanelContainer Storage" method="_on_game_manager_level_increased_signal"]
[connection signal="level_increased_signal" from="GameManager" to="Control Proceed/HBoxContainer/TextureRect Event Icon 3/Label Level" method="_level_increased_callback"]
[connection signal="pressed" from="Control Proceed/Button Proceed" to="GameManager" method="advance_event"]
